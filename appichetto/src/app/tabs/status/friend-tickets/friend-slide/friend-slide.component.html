<ion-segment (ionChange)="segmentChanged($event)" value="debts">
    <ion-segment-button value="debts">
        <ion-label>Debts</ion-label>
    </ion-segment-button>
    <ion-segment-button value="credits">
        <ion-label>Credits</ion-label>
    </ion-segment-button>
</ion-segment>

<div *ngIf="ticketsByFriendObs | async">
    <div *ngIf="debtsSelected">
        <ion-grid>
            <ion-row *ngFor="let ticket of ticketsByFriend">
                <ion-col>
                    <ion-card>
                        <ion-card-header (click)="selectTicket(ticket)" style="padding-top: -30%">
                            <ion-grid>
                                <ion-row>
                                    <ion-col></ion-col>
                                    <ion-col size="10">
                                        <ion-card-title>
                                            <ion-text style="text-align: left">
                                                Ticket {{ ticket.timestamp }}</ion-text>
                                        </ion-card-title>
                                    </ion-col>
                                    <ion-col>
                                        <ion-icon style="margin-left: 50%; margin-top: 17%;"
                                                  [name]="!(selectedTicketTimestamp === ticket.timestamp) ? 'chevron-down-outline' : 'chevron-up-outline'"
                                        ></ion-icon>
                                    </ion-col>
                                </ion-row>
                            </ion-grid>
                        </ion-card-header>

                        <ion-card-content>
                            <ion-text color="danger" style="margin-bottom: -30%">Debt: -{{ticket.totalPrice}}</ion-text>

                            <app-expandable [expanded]="selectedTicketTimestamp === ticket.timestamp">
                                <ion-grid>
                                    <ion-row>
                                        <ion-col>Name</ion-col>
                                        <ion-col>Quantity</ion-col>
                                        <ion-col>Price</ion-col>
                                        <ion-col>Participant</ion-col>
                                    </ion-row>
                                    <app-ticket-product *ngFor="let product of ticket.products;"
                                                        [product]="product"
                                                        [participants]="[ticket.participant]"
                                                        [viewMode]="true"
                                    ></app-ticket-product>
                                </ion-grid>
                            </app-expandable>
                        </ion-card-content>
                    </ion-card>
                </ion-col>
            </ion-row>
        </ion-grid>
    </div>
    <div *ngIf="!debtsSelected">
        <ion-grid>
            <ion-row *ngFor="let item of items">
                <ion-col>
                    <ion-card>
                        <ion-card-header (click)="expandItem(item)">
                            <ion-card-title>Ticket {{ item.ticket.timestamp }}
                            </ion-card-title>
                        </ion-card-header>


                        <ion-card-content>
                            <div slot="end">
                                <ion-text color="success">Credit: +{{item.credit}}</ion-text>
                            </div>

                            <app-expandable [expanded]="item.expanded">
                                <ion-grid>
                                    <ion-row>
                                        <ion-col>Name</ion-col>
                                        <ion-col>Quantity</ion-col>
                                        <ion-col>Price</ion-col>
                                        <ion-col>Participant</ion-col>
                                    </ion-row>
                                </ion-grid>
                                <ion-grid *ngFor="let product of item.ticket.products;">
                                    <app-ticket-product style="margin-left: 3%"
                                                        [product]="product"
                                                        [participants]="item.ticket.participants"
                                                        [viewMode]="true"
                                    ></app-ticket-product>
                                </ion-grid>
                            </app-expandable>
                        </ion-card-content>
                    </ion-card>
                </ion-col>
            </ion-row>
        </ion-grid>
    </div>
</div>


